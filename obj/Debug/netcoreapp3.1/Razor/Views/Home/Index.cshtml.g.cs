#pragma checksum "F:\Projects\Task\Views\Home\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "9c142cef41869b2faa5a991f99f016a25eb55449"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Home_Index), @"mvc.1.0.view", @"/Views/Home/Index.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "F:\Projects\Task\Views\_ViewImports.cshtml"
using poc;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "F:\Projects\Task\Views\_ViewImports.cshtml"
using poc.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"9c142cef41869b2faa5a991f99f016a25eb55449", @"/Views/Home/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"245fa154e55ab95c6cf3d3b3a6ab1bd2f0e80c39", @"/Views/_ViewImports.cshtml")]
    public class Views_Home_Index : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 1 "F:\Projects\Task\Views\Home\Index.cshtml"
  

    ViewData["Title"] = "Home Page";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<style>
    .line {
        fill: none;
        stroke: steelblue;
        stroke-width: 2px;
    }

    .area {
        fill: lightsteelblue;
    }

    .bar {
        fill: steelblue;
    }

    polyline {
        opacity: .3;
        stroke: black;
        stroke-width: 2px;
        fill: none;
    }

    /* Make the percentage on the text labels bold*/
    .labelName tspan {
        font-style: normal;
        font-weight: 700;
    }

    /* In biology we generally italicise species names. */
    .labelName {
        font-size: 0.9em;
        font-style: italic;
    }

    .graphHeight {
        height: 35opx;
    }

    #areaChart,
    #companyChart,
    #bankChart {
        height: 400px;
    }

    .card-header {
        text-transform: uppercase;
        font-weight: bold;
        line-height: 1.2em;
        word-spacing: normal;
        background-color: lightyellow;
        border: none;
    }

    div.tooltip {
        position: absolute;
        text-align: center;
        width: 80px;
        he");
            WriteLiteral(@"ight: 50px;
        padding: 2px;
        font: 12px sans-serif;
        background: lightsteelblue;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
    }

    .toolCircle {
        font-size: 1em;
        font-weight: bolder;
    }

    select {
        width: 100%;

    }

    .arc text {
        font: 10px sans-serif;
        text-anchor: middle;
    }

    .arc path {
        stroke: #fff;
    }
</style>

<section>

    <div class=""card mb-1"">
        <div class=""card-body"">
            <div class=""row col-md-12"">
                <div class=""col-md-6"">
                    <h5>Bank Position Summary</h5>
                </div>
                <div class=""col-md-6"">
                    <div class=""row"">
                        <div class=""col-md-4 text-center"" style=""color:green; font-weight:bolder"">
                            <h4 class=""m-0"">406.9M</h4>
                            <div style=""font-weight:bolder"">Surplus</div>
                        </div>
                   ");
            WriteLiteral(@"     <div class=""col-md-4 text-center"" style=""color:red;font-weight:bolder"">
                            <h4 class=""m-0"">107.9M</h4>
                            <div style=""font-weight:bolder"">Overdraft</div>
                        </div>
                        <div class=""col-md-4 text-center"" style=""font-weight:bolder"">
                            <h4 class=""m-0"">299.0M</h4>
                            <div style=""font-weight:bolder"">Net Balance</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class=""card mb-1"">
        <div class=""card-body"">
            <div class=""row col-md-12"">
                <div class=""col-md-2"">
                    <div class=""control-label"">Entity</div>
                    <div>");
#nullable restore
#line 125 "F:\Projects\Task\Views\Home\Index.cshtml"
                    Write(Html.DropDownList("parent", Enumerable.Empty<SelectListItem>(), "--Select Entity--", new {
                                @class = "form-control"}));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\n                </div>\n                <div class=\"col-md-3\">\n                    <div class=\"control-label\">Bank Name</div>\n                    <div>");
#nullable restore
#line 130 "F:\Projects\Task\Views\Home\Index.cshtml"
                    Write(Html.DropDownList("parent", Enumerable.Empty<SelectListItem>(), "--Select Bank--", new {
                                @class = "form-control"}));

#line default
#line hidden
#nullable disable
            WriteLiteral("</div>\n                </div>\n                <div class=\"col-md-3\">\n                    <div class=\"control-label\">Currency</div>\n                    <div>");
#nullable restore
#line 135 "F:\Projects\Task\Views\Home\Index.cshtml"
                    Write(Html.DropDownList("parent", Enumerable.Empty<SelectListItem>(), "--Select Currency--", new {
                                @class = "form-control"}));

#line default
#line hidden
#nullable disable
            WriteLiteral(@"</div>
                </div>
                <div class=""col-md-4"">
                    <div class=""control-label"">Date</div>
                    <div class=""row"">
                        <div class=""col-md-8"">
                            <input type=""date"" id=""datepicker"" class=""form-control""></div>
                        <div class=""col-md-4"">
                            <input type=""button"" value=""Search"" class=""btn btn-primary""></div>
                    </div>
                </div>
");
            WriteLiteral(@"            </div>
        </div>

    </div>

    <div class=""row col-md-12 mb-2"">
        <div class=""col-md-12"">
            <div class=""card"">
                <div class=""card-header"">
                    Daily Bank Balance Movement
                </div>
                <div class=""card-body"">
                    <div id=""areaChart"" class=""graphHeight"">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class=""row col-md-12"">
        <div class=""col-md-6 pr-1"">
            <div class=""card"">
                <div class=""card-header"">
                    Company wise Bank Balance
                </div>
                <div class=""card-body"">
                    <div id=""companyChart"" class=""graphHeight"">

                    </div>
                </div>
            </div>
        </div>
        <div class=""col-md-6 pl-1"">
            <div class=""card"">
                <div class=""card-header"">
                    Bank wise Bank balance (Value in Millio");
            WriteLiteral(@"ns)
                </div>
                <div class=""card-body"">
                    <div id=""bankChart"" class=""graphHeight"">

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script type=""text/javascript"">

    var chartData;
    var updatedData = [];
    var comapanyData = [];
    var bankData = [];
    var completeData;

    $(document).ready(function () {
        //alert('page loaded');
        $.getJSON(""json/data.json"", function (data) {
            completeData = data;
            chartData = data.Sheet1.filter(x => x.Division == ""Division 2"" && x.Currency == ""INR"");
            prepareData(chartData);
            areaChart(updatedData);

            prepareCompanyData(completeData.Sheet1);
            barChart(comapanyData);
            //console.log(comapanyData);
            prepareBankData(completeData.Sheet1);

            donutChart(bankData);
            //donutChartLabels(bankData);


        })
    })


    function prepareData(data)");
            WriteLiteral(@" {
        data.forEach((value, index) => {

            if (updatedData && updatedData.filter(x => x.BankBalanceDate == value.BankBalanceDate).length <= 0) {
                updatedData.push(value);
            } else {
                let existingData = updatedData.filter(x => x.BankBalanceDate == value.BankBalanceDate)[0];
                existingData.BankBalanceAmount = +existingData.BankBalanceAmount + (+value.BankBalanceAmount)
            }
        })
    }

    function prepareCompanyData(data) {
        //debugger;
        data.forEach((value, index) => {
            if (comapanyData && comapanyData.filter(x => x.EntityId == value.EntityId).length <= 0) {
                comapanyData.push(value)
            } else {
                let tempData = comapanyData.filter(x => x.EntityId == value.EntityId)[0];
                tempData.BankBalanceAmount = +(tempData.BankBalanceAmount) + (+(value.BankBalanceAmount));
            }
        })
    }

    function prepareBankData(data) {
        data.forEach((v");
            WriteLiteral(@"alue, index) => {
            if (bankData && bankData.filter(x => x.BankName == value.BankName).length <= 0) {
                bankData.push(value)
            } else {
                let tempData = bankData.filter(x => x.BankName == value.BankName)[0];
                tempData.BankBalanceAmount = (+tempData.BankBalanceAmount) + (+value.BankBalanceAmount);
            }
        })
    }

    function areaChart(data) {

        let bindingElementWidth = $('#areaChart').width();
        let bindingElementHeight = $('#areaChart').height();
        var margin = { top: 20, right: 40, bottom: 30, left: 100 },
            width = bindingElementWidth - margin.left - margin.right,
            height = bindingElementHeight - margin.top - margin.bottom;



        var dateFormat = d3.timeFormat(""%d-%m-%y"")
        var parseTime = d3.timeParse(""%m/%d/%y"");
        var formatTime = d3.timeFormat(""%e %B %y"");

        var x = d3.scaleTime().range([0, width]);
        var y = d3.scaleLinear().range([height, 0]);


       ");
            WriteLiteral(@" var area = d3.area()
            .x(function (d) { return x(d.date); })
            .y0(height)
            .y1(function (d) { return y(+d.close); });


        var valueline = d3.line()
            .x(function (d) { return x(d.date); })
            .y(function (d) { return y(+d.close); });

        var div = d3.select(""body"").append(""div"")
            .attr(""class"", ""tooltip"")
            .style(""opacity"", 0);

        var svg = d3.select(""#areaChart"").append(""svg"")
            .attr(""width"", width + margin.left + margin.right)
            .attr(""height"", height + margin.top + margin.bottom)
            .append(""g"")
            .attr(""transform"",
                ""translate("" + margin.left + "","" + margin.top + "")"");

        data.forEach(function (d) {

            d.date = parseTime((d.BankBalanceDate));
            d.close = + Math.round(d.BankBalanceAmount);
        });


        data.sort((a, b) => b.date - a.date)
        console.log(data);
        // scale the range of the data
        x.domain(d3.exte");
            WriteLiteral(@"nt(data, function (d) { return d.date; }));
        y.domain([0, d3.max(data, function (d) { return d.close; })]);

        // add the area
        svg.append(""path"")
            .data([data])
            .attr(""class"", ""area"")
            .attr(""d"", area);

        // add the valueline path.
        svg.append(""path"")
            .data([data])
            .attr(""class"", ""line"")
            .attr(""d"", valueline);

        // add the X Axis
        svg.append(""g"")
            .attr(""transform"", ""translate(0,"" + height + "")"")
            .call(d3.axisBottom(x).tickFormat(d3.timeFormat(""%d-%b-%y"")));

        // add the Y Axis
        svg.append(""g"")
            .call(d3.axisLeft(y));



        svg.selectAll("".dot"")
            .data(data)
            .enter().append(""circle"") // Uses the enter().append() method
            .attr(""class"", ""dot"") // Assign a class for styling
            .attr(""cx"", function (d, i) { return x(d.date) })
            .attr(""cy"", function (d) { return y(d.close) })
            .att");
            WriteLiteral(@"r(""r"", 5)
            .on(""mouseover"", function (d) {
                div.transition()
                    .duration(200)
                    .style(""opacity"", .9);
                div.html(formatTime(d.date) + ""<br/>"" + d.close)
                    .style(""left"", (d3.event.pageX) + ""px"")
                    .style(""top"", (d3.event.pageY - 28) + ""px"");
            })
            .on(""mouseout"", function (d) {
                div.transition()
                    .duration(500)
                    .style(""opacity"", 0);
            });



    }

    function barChart(data) {
        let bindingElementWidth = $('#companyChart').width();
        let bindingElementHeight = $('#companyChart').height();
        var margin = { top: 20, right: 20, bottom: 50, left: 50 },
            width = bindingElementWidth - margin.left - margin.right,
            height = bindingElementHeight - margin.top - margin.bottom;

        // set the ranges
        var y = d3.scaleBand()
            .range([height, 0])
            .padding");
            WriteLiteral(@"(0.1);

        var x = d3.scaleLinear()
            .range([0, width]);

        // append the svg object to the body of the page
        // append a 'group' element to 'svg'
        // moves the 'group' element to the top left margin
        var svg = d3.select(""#companyChart"").append(""svg"")
            .attr(""width"", width + margin.left + margin.right)
            .attr(""height"", height + margin.top + margin.bottom)
            .append(""g"")
            .attr(""transform"",
                ""translate("" + margin.left + "","" + margin.top + "")"");

        // format the data
        data.forEach(function (d) {
            //console.log(d.BankBalanceAmount);
            //console.log(Math.round(+d.BankBalanceAmount/10000000,0));
            d.BankBalanceAmount = (Math.round(d.BankBalanceAmount / 1000000, 0));
        });

        // console.log(data);

        // Scale the range of the data in the domains
        x.domain([0, d3.max(data, function (d) { return d.BankBalanceAmount; })])
        y.domain(data.map(fun");
            WriteLiteral(@"ction (d) { return d.EntityId; }));
        //y.domain([0, d3.max(data, function(d) { return d.sales; })]);

        // append the rectangles for the bar chart
        var bars = svg.selectAll("".bar"")
            .data(data)
            .enter().append(""rect"")
            .attr(""class"", ""bar"")
            .attr(""width"", function (d) { return x(d.BankBalanceAmount); })
            .attr(""y"", function (d) { return y(d.EntityId); })
            .attr(""height"", y.bandwidth());

        bars.append(""text"")
            .attr(""class"", ""label"")
            //y position of the label is halfway down the bar
            .attr(""y"", function (d) {
                return y(d.EntityId) + y.bandwidth() / 2 + 4;
            })
            //x position is 3 pixels to the right of the bar
            .attr(""x"", function (d) {
                return x(d.BankBalanceAmount) + 3;
            })
            .text(function (d) {
                return d.BankBalanceAmount;
            });
        // add the x Axis
        svg.append(""");
            WriteLiteral(@"g"")
            .attr(""transform"", ""translate(0,"" + height + "")"")
            .call(d3.axisBottom(x));

        // add the y Axis
        svg.append(""g"")
            .call(d3.axisLeft(y));

        svg.append(""text"")
            .attr(""class"", ""x label"")
            .attr(""text-anchor"", ""center"")
            .attr(""x"", width - 250)
            .attr(""y"", height + 50)
            .text(""Value in Millions"");
    }

    function donutChart(data) {
        let bindingElementWidth = $('#bankChart').width();
        let bindingElementHeight = $('#bankChart').height();
        var svg = d3.select(""#bankChart"").append(""svg"")
            .attr(""width"", bindingElementWidth)
            .attr(""height"", bindingElementHeight)
            .append(""g"");

        svg.append(""g"")
            .attr(""class"", ""slices"");
        svg.append(""g"")
            .attr(""class"", ""labels"");
        svg.append(""g"")
            .attr(""class"", ""lines"");
        var width = 500;
        var height = 400;
        var radius = Math.min(width, h");
            WriteLiteral(@"eight) / 2;
        var color = d3.scaleOrdinal(d3.schemeCategory20);
        //var data = [26, 25, 10, 30, 30, 50, 33, 56, 38];

        var tempData = [];
        var total = 0;
        data.forEach((d) => {
            d.BankBalanceAmount = (+d.BankBalanceAmount / 1000000).toFixed(2);
            total = total + +(d.BankBalanceAmount);
        });

        console.log(tempData)
        //tempData = [26, 25, 10, 30, 30, 50, 33, 56, 38];

        var pie = d3.pie().sort(null).value(d => +d.BankBalanceAmount);
        var arc = d3.arc().innerRadius(radius * 0.8).outerRadius(radius * 0.6);

        var outerArc = d3.arc()
            .outerRadius(radius * 0.9)
            .innerRadius(radius * 0.9);

        svg.attr(""transform"", ""translate("" + width / 2 + "","" + height / 2 + "")"");

        svg.selectAll('path')
            .data(pie(data))
            .enter()
            .append('path')
            .attr('d', arc)
            .attr('fill', (d, i) => color(d.data.BankName));
        svg.append('g').classed('la");
            WriteLiteral(@"bels', true);
        svg.append('g').classed('lines', true);


        var polyline = svg.select('.lines')
            .selectAll('polyline')
            .data(pie(data))
            .enter().append('polyline')
            .attr('points', function (d) {

                // see label transform function for explanations of these three lines.
                var pos = outerArc.centroid(d);
                pos[0] = radius * 0.95 * (midAngle(d) < Math.PI ? 1 : -1);
                return [arc.centroid(d), outerArc.centroid(d), pos]
            });



        var label = svg.select('.labels').selectAll('text')
            .data(pie(data))
            .enter().append('text')
            .attr('dy', '.35em')
            .html(function (d) {
                console.log(d);
                return (d.data.BankBalanceAmount);
            })
            .attr('transform', function (d) {
                var pos = outerArc.centroid(d);
                pos[0] = radius * 0.95 * (midAngle(d) < Math.PI ? 1 : -1);
             ");
            WriteLiteral(@"   return 'translate(' + pos + ')';
            })
            .style('text-anchor', function (d) {
                return (midAngle(d)) < Math.PI ? 'start' : 'end';
            });

        svg.append('text')
            .attr('class', 'toolCircle')
            .attr('dy', -15) // hard-coded. can adjust this to adjust text vertical alignment in tooltip
            .html(""Total Balance:"" + total) // add text to the circle.
            .style('font-size', '.9em')
            .style('text-anchor', 'middle');


        const l = svg.append('g')
            .attr('transform', `translate(${-width/2},${height/2 - 20})`);
        ;

        const xl = d3.scaleBand()
            .range([0, width])
            .padding(0.3)
            .domain(data.map(d => d.BankName))
            ;

        const legend = l.selectAll('.chart-legend')
            .data(color.domain())
            .enter()
            .append('g')
            .attr('class', 'chart-legend')
            .attr('transform', (d, i) =>{ 
                if(");
            WriteLiteral(@"i<=4)
                return `translate(${xl(d)},-10)`;
                else
                 return `translate(${xl(d)/2},5)`;
                })
            ;

        legend.append('rect')
            .attr('width', 12)
            .attr('height', 12)
            .style('fill', color)
            ;

        legend.append('text')
            .attr('x', 20)
            .attr('y', 10)
            .text(d => d)
            ;

        function midAngle(d) { return d.startAngle + (d.endAngle - d.startAngle) / 2; }
    }

    function donutChartLabels(data) {
        var svg = d3.select(""svg""),
            width = +$('#bankChart').width(),
            height = +$('#bankChart').height(),
            radius = Math.min(width, height) / 2,
            g = svg.append(""g"").attr(""transform"", ""translate("" + width / 2 + "","" + height / 2 + "")"");

        var color = d3.scaleOrdinal([""#98abc5"", ""#8a89a6"", ""#7b6888"", ""#6b486b"", ""#a05d56"", ""#d0743c"", ""#ff8c00""]);

        var pie = d3.pie()
            .sort(null)
           ");
            WriteLiteral(@" .value(function (d) { return +d.BankBalanceAmount; });

        var path = d3.arc()
            .outerRadius(radius - 10)
            .innerRadius(radius - 70);

        var label = d3.arc()
            .outerRadius(radius - 40)
            .innerRadius(radius - 40);

        data.forEach(function (d) {
            console.log(d);
            d.BankBalanceAmount = (Math.round(d.BankBalanceAmount / 1000000, 0));
        });

        var arc = g.selectAll("".arc"")
            .data(pie(data))
            .enter().append(""g"")
            .attr(""class"", ""arc"");

        arc.append(""path"")
            .attr(""d"", path)
            .attr(""fill"", function (d) { return color(d.BankName); });

        arc.append(""text"")
            .attr(""transform"", function (d) { return ""translate("" + label.centroid(d) + "")""; })
            .attr(""dy"", ""0.35em"")
            .text(function (d) { return d.data.age; });

    }
</script>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
